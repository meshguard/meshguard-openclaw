{
  "id": "meshguard",
  "name": "MeshGuard Governance",
  "description": "AI agent governance, policy enforcement, and audit logging",
  "version": "0.5.0",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "enabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable MeshGuard governance (requires apiKey and agentId when true)"
      },
      "apiKey": {
        "type": "string",
        "description": "MeshGuard API key (msk_xxx) - required when enabled"
      },
      "agentId": {
        "type": "string",
        "description": "MeshGuard agent ID (agent_xxx) - required when enabled"
      },
      "gatewayUrl": {
        "type": "string",
        "default": "https://dashboard.meshguard.app",
        "description": "MeshGuard gateway URL"
      },
      "mode": {
        "type": "string",
        "enum": ["enforce", "audit", "bypass"],
        "default": "enforce",
        "description": "Governance mode: enforce (block violations), audit (log only), bypass (disabled)"
      },
      "auditLevel": {
        "type": "string",
        "enum": ["minimal", "standard", "verbose"],
        "default": "standard",
        "description": "Audit log verbosity"
      },
      "cacheTimeoutMs": {
        "type": "number",
        "default": 60000,
        "description": "Policy cache timeout in milliseconds"
      },
      "failOpen": {
        "type": "boolean",
        "default": false,
        "description": "If true, allow actions when MeshGuard is unreachable"
      }
    },
    "if": {
      "properties": { "enabled": { "const": true } },
      "required": ["enabled"]
    },
    "then": {
      "required": ["apiKey", "agentId"]
    }
  }
}
